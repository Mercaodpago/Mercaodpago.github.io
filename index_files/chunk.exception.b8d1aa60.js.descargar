(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[6191],{43349:(e,t,n)=>{const r=n(19955),{connect:o}=n(69507),i=n(10469);class s extends r.Component{constructor(e){super(e),this.state={resize:0}}UNSAFE_componentWillReceiveProps(e){e.resize!==this.state.resize&&this.sendResizeMessage(e,this.props.step)}sendResizeMessage(e,t){switch(t){case"wallet_payment":i.walletPayment(e);break;case"wallet_congrats_approved":case"wallet_congrats_rejected":i.walletCongrats();break;default:i.defaultRule()}}render(){return null}}const l=e=>({resize:e.size.actionToTake,step:e.page.flow.step,inputValues:e.inputValues,collapsible:e.collapsible});e.exports=o(l)(s)},4722:(e,t,n)=>{const r=n(50853)(!0);e.exports=()=>{r.resize(3e3)}},10469:(e,t,n)=>{const r=n(2708),o=n(73697),i=n(4722);e.exports={walletPayment:r,walletCongrats:o,defaultRule:i}},73697:(e,t,n)=>{const r=n(50853)(!0);e.exports=()=>{r.resize(370)}},2708:(e,t,n)=>{const r=n(50853)(!0),o={1:335,2:410,3:495,fullSize:1200};e.exports=e=>{let t="";if(e.collapsible.installments_collapsible_selector||e.collapsible.payment_option_selector||e.collapsible.wallet_summary)t="fullSize";else{t=((e.inputValues.visibility.wallet_payment_installments_collapsible_selector||!1)+(e.inputValues.visibility.wallet_payment_cvv||!1)+(e.inputValues.visibility.wallet_payment_payment_options_selector||!1)).toString()}r.resize(o[t])}},55174:(e,t,n)=>{var r,o,i=n(18053);const s=n(19955),{bindActionCreators:l}=n(24333),{connect:a}=n(69507),{injectI18n:c}=n(97465),u=n(94875),p=n(25226),d=n(90588),v=n(71835),f=n(50375),g=n(98761),{getQueryParams:h}=n(95922),{STEP_RETRY:y,CHANGE_IFRAME_SIZE:_}=n(88220),x=n(80328),m=n(43349),{setCookie:R,getCookie:b}=n(78499),{COOKIES:{RECOVERY_ERROR_COUNTER:C}}=n(3320);class E extends s.Component{constructor(e){super(e);const{i18n:t}=e;this.state={retryCounter:0},this.handleRetry=this.handleRetry.bind(this),this.redirectToStepRetry=this.redirectToStepRetry.bind(this),this.getRecoveryCookie=this.getRecoveryCookie.bind(this),this.translations=u(t)}componentDidMount(){this.props.sizeActions[_](1e3),this.setState({retryCounter:this.getRecoveryCookie()})}handleRetry(e,t){var n,r;let o=(null===(n=this.state.retryCounter)||void 0===n?void 0:n.flowId)===(null==e?void 0:e.id)?null===(r=this.state.retryCounter)||void 0===r?void 0:r.counter:0;if(o>2)return;o++;const i=null==t?void 0:t.substring(0,2);R(C,JSON.stringify({flowId:null==e?void 0:e.id,counter:o,errorComesFrom:i}),.125),this.redirectToStepRetry(e)}getRecoveryCookie(){return b(C)?JSON.parse(b(C)):null}redirectToStepRetry(e){this.props.stepActions[y](null==e?void 0:e.id,null==e?void 0:e.type,h(),this.props.history)}render(){var e,t,n;const{stepTitle:s,trackingPath:l,analytics:a,deviceType:c,showRetry:u,history:f,error_code:g}=this.props,h=g||(null===(e=f.location)||void 0===e||null===(e=e.state)||void 0===e?void 0:e.errorCode),{retryCounter:y}=this.state;return i(p,{title:s,currentStep:"exception",trackingPath:l,analytics:a,deviceType:c},void 0,i(d,{message:this.translations.OH_NO_SOMETHING_WENT_WRONG,errorCode:h},void 0,r||(r=i(x,{}))),o||(o=i(m,{})),(u||(null===(t=f.location)||void 0===t||null===(t=t.state)||void 0===t?void 0:t.showRetry))&&!((null==y?void 0:y.flowId)===(null===(n=this.props.flow)||void 0===n?void 0:n.id)&&(null==y?void 0:y.counter)>2)&&i(v,{trackEvent:{action:"CLICK_RETRY_EXCEPTION_BUTTON",category:"VISIBLE_COMPONENT",label:"RETRY",type:"CLICK"},id:"back_btn_retry",text:this.translations.RETRY,kind:"link",onClick:()=>this.handleRetry(this.props.flow,h)}))}}E.defaultProps={flow:null,stepTitle:"",currentStep:"",pageData:{},trackingPath:"failure",analytics:{},deviceType:"",stepActions:{},i18n:{gettext:e=>e},showRetry:!1,history:{},error_code:""};const w=e=>({stepActions:l(f,e),sizeActions:l(g,e)}),S=e=>{var t;return{flow:null===(t=e.page)||void 0===t?void 0:t.flow}};e.exports=c(a(S,w)(E))},98761:(e,t,n)=>{const{createAction:r}=n(54969),{CHANGE_IFRAME_SIZE:o}=n(88220),i=r(o);e.exports={[o]:e=>t=>{t(i(e))}}},78499:e=>{const t=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:365;const r=new Date;r.setTime(r.getTime()+24*n*60*60*1e3);const o="expires=".concat(r.toUTCString()),i="".concat(e,"=").concat(t,";").concat(o,";").concat("secure",";").concat("SameSite=strict",";").concat("/");document.cookie=i};e.exports={setCookie:t,getCookie:e=>{var t;const n=new RegExp("(?:^|; )".concat(e.replace("/([.$?*|{}()[]\\/+^])/g, '\\$1'"),"=([^;]*)")).exec(null===(t=document)||void 0===t?void 0:t.cookie);return!!n&&decodeURIComponent(n[1])},deleteCookiesByKey:e=>t(e,"",-1)}},50853:(e,t,n)=>{const r=n(23919)(!0),o="resize",i="open_wallet_login";e.exports=()=>({resize:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return r.emit(o,{size:e})},openWalletLogin:()=>r.emit(i)})},23919:function(e,t,n){var r=this;const o=n(52372);e.exports=e=>({emit:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];((e,t)=>{let[n,r]=e;if(!t)return;const o=["[".concat(n,"]")];r&&o.push("function"!=typeof r?r:"fn")})(n,e),o.emit.apply(r,n)},on:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];o.on.apply(r,t)}})},52372:(e,t,n)=>{"use strict";var r,o,i=[],s={},l="/*framebus*/";function a(e){var t,n=p(this);return!d(e)&&(!d(n)&&(!1!==(t=v(e,Array.prototype.slice.call(arguments,1),n))&&(x(r.top||r.self,t,n),!0)))}function c(e,t){var n=p(this);return!R(e,t,n)&&(s[n]=s[n]||{},s[n][e]=s[n][e]||[],s[n][e].push(t),!0)}function u(e,t){var n,r,o=p(this);if(R(e,t,o))return!1;if(!(r=s[o]&&s[o][e]))return!1;for(n=0;n<r.length;n++)if(r[n]===t)return r.splice(n,1),!0;return!1}function p(e){return e&&e._origin||"*"}function d(e){return"string"!=typeof e}function v(e,t,n){var r=!1,o={event:e,origin:n},i=t[t.length-1];"function"==typeof i&&(o.reply=m(i,n),t=t.slice(0,-1)),o.args=t;try{r=l+JSON.stringify(o)}catch(e){throw new Error("Could not stringify event: "+e.message)}return r}function f(e){var t,n,r,o;if(e.data.slice(0,l.length)!==l)return!1;try{t=JSON.parse(e.data.slice(l.length))}catch(e){return!1}return null!=t.reply&&(n=e.origin,r=e.source,o=t.reply,t.reply=function(e){var t;return!!r&&(!1!==(t=v(o,[e],n))&&void r.postMessage(t,n))},t.args.push(t.reply)),t}function g(e){r||((r=e||n.g).addEventListener?r.addEventListener("message",y,!1):r.attachEvent?r.attachEvent("onmessage",y):null===r.onmessage?r.onmessage=y:r=null)}function h(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function y(e){var t;d(e.data)||(t=f(e))&&(_("*",t.event,t.args,e),_(e.origin,t.event,t.args,e),function(e,t,n){var r,o;for(r=i.length-1;r>=0;r--)!0===(o=i[r]).closed?i=i.slice(r,1):n!==o&&x(o.top,e,t)}(e.data,t.origin,e.source))}function _(e,t,n,r){var o;if(s[e]&&s[e][t])for(o=0;o<s[e][t].length;o++)s[e][t][o].apply(r,n)}function x(e,t,n){var r,o=0;try{for(e.postMessage(t,n),function(e){return e.top===e&&null!=e.opener&&e.opener!==e&&!0!==e.opener.closed}(e)&&x(e.opener.top,t,n);r=e.frames[o];)x(r,t,n),o++}catch(e){}}function m(e,t){var n=h();return o.target(t).subscribe(n,(function r(i,s){e(i,s),o.target(t).unsubscribe(n,r)})),n}function R(e,t,n){return!!d(e)||("function"!=typeof t||!!d(n))}g(),o={target:function(e){var t,n={};for(t in o)o.hasOwnProperty(t)&&(n[t]=o[t]);return n._origin=e||"*",n},_packagePayload:v,_unpackPayload:f,_attach:g,_detach:function(){null!=r&&(r.removeEventListener?r.removeEventListener("message",y,!1):r.detachEvent?r.detachEvent("onmessage",y):r.onmessage===y&&(r.onmessage=null),r=null,i=[],s={})},_dispatch:_,_broadcast:x,_subscribeReplier:m,_subscriptionArgsInvalid:R,_onmessage:y,_uuid:h,_getSubscribers:function(){return s},_win:function(){return r},include:function(e){return null!=e&&(null!=e.Window&&(e.constructor===e.Window&&(i.push(e),!0)))},publish:a,pub:a,trigger:a,emit:a,subscribe:c,sub:c,on:c,unsubscribe:u,unsub:u,off:u},e.exports=o}}]);
//# sourceMappingURL=chunk.exception.b8d1aa60.js.map